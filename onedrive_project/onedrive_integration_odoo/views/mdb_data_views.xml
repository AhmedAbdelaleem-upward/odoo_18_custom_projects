<?xml version="1.0" encoding="UTF-8" ?>
<odoo>
    <!-- List View for MDB Table Data -->
    <record id="mdb_table_data_view_list" model="ir.ui.view">
        <field name="name">mdb.table.data.list</field>
        <field name="model">mdb.table.data</field>
        <field name="arch" type="xml">
            <list string="MDB Tables" decoration-info="status == 'processing'" decoration-muted="status == 'pending'" decoration-danger="status == 'failed'" decoration-success="status == 'done'">
                <field name="name"/>
                <field name="table_name"/>
                <field name="row_count"/>
                <field name="read_date"/>
                <field name="status" widget="badge" 
                       decoration-info="status == 'processing'" 
                       decoration-muted="status == 'pending'" 
                       decoration-danger="status == 'failed'" 
                       decoration-success="status == 'done'"/>
            </list>
        </field>
    </record>

    <!-- Form View for MDB Table Data -->
    <record id="mdb_table_data_view_form" model="ir.ui.view">
        <field name="name">mdb.table.data.form</field>
        <field name="model">mdb.table.data</field>
        <field name="arch" type="xml">
            <form string="MDB Table Data">
                <header>
                    <button name="action_retry_import" string="Retry Import" type="object" class="btn-primary" 
                            invisible="status not in ('failed', 'pending')"/>
                    <field name="status" widget="statusbar" statusbar_visible="pending,downloading,processing,done"/>
                </header>
                <sheet>
                    <!-- Error Message Alert -->
                    <div class="alert alert-danger" role="status" invisible="status != 'failed'">
                        <h4 class="alert-heading">Import Failed</h4>
                        <field name="error_message"/>
                    </div>

                    <group>
                        <group>
                            <field name="name"/>
                            <field name="table_name"/>
                            <field name="download_url" groups="base.group_no_one"/>
                        </group>
                        <group>
                            <field name="row_count"/>
                            <field name="read_date"/>
                            <field name="onedrive_file_id" groups="base.group_no_one"/>
                        </group>
                    </group>
                    <notebook>
                        <page string="Columns">
                            <field name="columns" widget="text"/>
                        </page>
                        <page string="Data Rows">
                            <field name="row_ids">
                                <list limit="100">
                                    <field name="id" optional="hide"/>
                                    <field name="data"/>
                                </list>
                            </field>
                        </page>
                        <page string="Raw Data (Legacy)" invisible="1">
                            <field name="data" widget="text"/>
                        </page>
                    </notebook>
                </sheet>
            </form>
        </field>
    </record>

    <!-- Action for MDB Table Data -->
    <record id="mdb_table_data_action" model="ir.actions.act_window">
        <field name="name">MDB Data</field>
        <field name="res_model">mdb.table.data</field>
        <field name="view_mode">list,form</field>
    </record>

    <!-- Menu item under OneDrive Dashboard -->
    <menuitem id="mdb_data_menu"
              name="MDB Data"
              parent="onedrive_dashboard_menu_root"
              action="mdb_table_data_action"
              sequence="10"/>
</odoo>
